# Программа для работы с лазерным дальномером TW10SP.

##### Подготовка к проведению измерений:
1.	Запустить программу Rangefinder.exe (также внутри архива). 
2.	Подключить дальномер к ПК.
3.	Выбрать в выпадающем меню соответствующий COM-порт.

##### Интерфейс программы:
![image](https://user-images.githubusercontent.com/10982897/187225098-c7e59604-e76d-4ffa-990b-0bef6aed675b.png)

Для проведения измерения необходимо нажать кнопку MEASURE.
При нажатии на кнопку она блокируется на время или до получения ответа (сделано для защиты, т.к. дальномер может зависать при частой отсылке команд).

Результат измерения отразится в поле справа, последнее измерение будет самым верхним, формат ответа следующий:
##### ВРЕМЯ – ДИСТАНЦИЯ [ ПОБАЙТОВЫЙ ВИД ОТВЕТА ]

Для очистки окна можно использовать кнопку CLEAR

## Драйвера:
##### Драйвер Windows: http://www.wch-ic.com/downloads/CH341SER_EXE.html      
##### Драйвер Linux: http://www.wch-ic.com/downloads/CH341SER_LINUX_ZIP.html

## Параметры COM соединения:
- Бодрейт (baudrate): 9600
- Фрейм (data): 8
- Стоп биты (stop): 1
- Бит четности (parity): отсутствует


Для проведения измерения нужно отправить следующую последовательность байт:

| №       | 0    | 1     | 2     | 3    | 4     | 5    |     6 | 7    |
| ------- | ---- | ----- | ----- | ---- | ----- | ---- | ----- |  --- |
| Данные  | 0x01 | 0x03  | 0x00  | 0x0F | 0x00  | 0x02 |  0xF4 | 0x08 |

После получения последовательности дальномер несколько раз мигнет лазерным излучателем
(красная точка) и вернет ответную последовательность:
|№      |0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   |
| ----- | -- | --- | --- | --- | --- | --- | --- | -   | -   |
|Данные |0x01| 0x03| 0x04| __0xGH__| __0xIJ__| __0xKL__| __0xMN__| 0x??| 0x??|

Где байты 3..6 содержат значение проведенного измерения в виде длинного целого:
__0xGHIJKLMN__ - миллиметров от поверхности линзы дальномера до поверхности отражения луча.
Байты 7 и 8 содержат контрольную сумму (CRC-16-ANSI).

Ограничения.
Проведение измерений возможно не чаще 1-го раза в 3 секунды.
При получении команды во время измерения дальномер игнорирует команду.
